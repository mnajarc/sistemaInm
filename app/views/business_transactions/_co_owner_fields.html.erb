<!-- app/views/business_transactions/_co_owner_fields.html.erb -->
<div class="co-owner-item border rounded p-3 mb-3" data-co-owners-target="item">
  <div class="row align-items-center">
    <div class="col-md-4">
      <%= f.label :client_id, "Cliente", class: "form-label" %>
      <%= f.select :client_id, 
                     options_from_collection_for_select(@clients, :id, :name),
                     { prompt: "Seleccionar cliente..." },
                     { class: "form-select client-select",
                       data: { action: "change->co-owners#updateClientName" } } %>
    </div>
    <div class="col-md-3">
      <%= f.label :person_name, "O escribir nombre", class: "form-label" %>
      <%= f.text_field :person_name, 
                         placeholder: "Nombre completo", 
                         class: "form-control" %>
    </div>
    <div class="col-md-2">
      <%= f.label :percentage, "Porcentaje", class: "form-label" %>
      <div class="input-group">
        <%= f.number_field :percentage, 
                             class: "form-control", 
                             step: 0.01, 
                             min: 0, 
                             max: 100,
                             data: { action: "input->co-owners#updatePercentages" } %>
        <span class="input-group-text">%</span>
      </div>
    </div>
    <div class="col-md-2">
      <%= f.label :role, "Rol", class: "form-label" %>
      <%= f.select :role, 
                     @roles,
                     { prompt: "Seleccionar..." },
                     { class: "form-select" } %>
    </div>
    <div class="col-md-1">
      <label class="form-label">&nbsp;</label>
      <button type="button" 
              class="btn btn-outline-danger btn-sm d-block" 
              data-action="click->co-owners#removeCoOwner"
              title="Eliminar copropietario">
        <i class="fas fa-trash"></i>
      </button>
    </div>
  </div>
  
  <!-- Campos adicionales colapsables -->
  <div class="mt-2">
    <button type="button" 
            class="btn btn-link btn-sm p-0" 
            data-bs-toggle="collapse" 
            data-bs-target="#advanced-<%= f.index || rand(1000) %>"
            aria-expanded="false">
      <i class="fas fa-cog me-1"></i> Opciones avanzadas
    </button>
  </div>
  
  <div class="collapse mt-2" id="advanced-<%= f.index || rand(1000) %>">
    <div class="row">
      <div class="col-md-6">
        <div class="form-check">
          <%= f.check_box :deceased, class: "form-check-input" %>
          <%= f.label :deceased, "Finado", class: "form-check-label" %>
        </div>
      </div>
      <div class="col-md-6">
        <%= f.text_area :inheritance_case_notes, 
                          placeholder: "Notas del caso de herencia...", 
                          rows: 2,
                          class: "form-control form-control-sm" %>
      </div>
    </div>
  </div>
</div>
